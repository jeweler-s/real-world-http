# 4μ¥. HTTP/1.1μ μ‹ νƒμ¤: κ³ μ†ν™”μ™€ μ•μ •μ„±μ„ μ¶”κµ¬ν• ν™•μ¥

# HTTP/1.1 λ³€κ²½μ‚¬ν•­

- ν†µμ‹  κ³ μ†ν™” (`Keep-Alive`κ°€ κΈ°λ³Έμ μΌλ΅ μ ν¨)
- TLSμ— μν• μ•”νΈν™” ν†µμ‹  μ§€μ›
- μƒ λ©”μ„λ“ μ¶”κ°€
- ν”„λ΅ν† μ½ μ—…κ·Έλ μ΄λ“
- μ΄λ¦„μ„ μ‚¬μ©ν• κ°€μƒ νΈμ¤νΈ μ§€μ›
- ν¬κΈ°λ¥Ό μ‚¬μ „μ— μ• μ μ—†λ” μ½ν…μΈ μ μ²­ν¬ μ „μ†΅ μΈμ½”λ”© μ§€μ›

# ν†µμ‹  κ³ μ†ν™”

> Connection: Keep-Alive
> 
- μ—°μ†λ μ”μ²­μ—λ” μ ‘μ†μ„ λ‹¤μ‹ μ΄μ©ν•μ—¬ ν•Έλ“μ…°μ΄ν¬ μ¤„μ„ β‡’ μ‘λ‹µ μ‹κ°„ κ°μ„ 
- μ§€μ† μ‹κ°„μ€ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ λ¨λ‘ κ°€μ§€κ³  μμ

> Connection: Close
> 
- ν΄λΌμ΄μ–ΈνΈλ‚ μ„λ²„ μ¤‘ ν• μ½μ΄ μ„ ν—¤λ”λ¥Ό μ‚¬μ©ν•΄ μ ‘μ†μ„ λκ±°λ‚ νƒ€μ„μ•„μ›ƒ λ  λ•κΉμ§€ μ—°κ²° μ μ§€

# νμ΄ν”„λΌμ΄λ‹

- μµμ΄μ μ”μ²­μ΄ μ™„λ£λκΈ° μ „μ— λ‹¤μ μ”μ²­μ„ λ³΄λ‚΄λ” κΈ°μ 
- `Keep-Alive` μ΄μ©μ„ μ „μ λ΅ ν•¨
- ν„μ¬ κΈ°λ³ΈμΌλ΅ ν•΄λ‹Ή μµμ…μ„ ν™μ„±ν™”ν• λΈλΌμ°μ €λ” κ±°μ μ—†μ (μ¤νλΌ, iOS 5 μ΄ν›„ μ‚¬νλ¦¬)
- HTTP/2μ—μ„ μ¤νΈλ¦ΌμΌλ΅ κ°νΈλ¨

<aside>
π’΅ **HOL λΈ”λ΅ν‚Ή(Head Of Line Blocking)**
μ”μ²­ λ°›μ€ μμ„λ€λ΅ μ‘λ‹µ μ‹, μ‘λ‹µ μƒμ„±μ— μ‹κ°„μ΄ κ±Έλ¦¬κ±°λ‚ ν¬κΈ°κ°€ ν° νμΌμ„ λ°ν™ν•λ” μ²λ¦¬κ°€ μμΌλ©΄ λ‹¤λ¥Έ μ‘λ‹µμ— μν–¥μ„ μ£Όλ” ν„μƒ

</aside>

# μ „μ†΅ κ³„μΈµ λ³΄μ•(TLS)

- HTTP μ΄μ™Έμ— SMTPS λ“± κΈ°μ΅΄ ν”„λ΅ν† μ½μ λ²„μ „μ—…μ—λ„ μ΄μ©
- κ³µν†µ ν‚¤ λ°©μ‹κ³Ό κ³µκ° ν‚¤ λ°©μ‹μ„ μ΅°ν•©ν•μ—¬ μ‚¬μ©
    - ν†µμ‹ λ§λ‹¤ ν• λ²λ§ μ‚¬μ©λλ” κ³µν†µ ν‚¤ μƒμ„±ν•μ—¬ κ³µκ° ν‚¤ λ°©μ‹μ„ μ‚¬μ©ν•΄ ν†µμ‹  μƒλ€μ—κ² ν‚¤ μ „λ‹¬
    - μ΄ν›„ κ³µν†µ ν‚¤λ΅ κ³ μ† μ•”νΈν™”
- ν”ν `SSL`μ΄λΌ λ¶€λ¥΄λ” μ©μ–΄λ” λ¨λ‘ `TLS`μ— ν•΄λ‹Ήλ¨

## ν†µμ‹  μ μ°¨

![https://brunch.co.kr/@swimjiy/47](https://prod-files-secure.s3.us-west-2.amazonaws.com/31151178-2abf-4285-b27d-d78331d3f581/e077408a-2b6a-4281-a306-a3116ccafd9f/Untitled.png)

https://brunch.co.kr/@swimjiy/47

- `1λ‹¨κ³„` : SSL μ„λ²„ μΈμ¦μ„ μ·¨λ“
- `2λ‹¨κ³„` : μ„λ²„ μΈμ¦μ„μ μ‹ λΆ°μ„± ν™•μΈ
- `3λ‹¨κ³„` : κ³µν†µ ν‚¤λ¥Ό μ‘μ„±ν•΄ μΈμ¦μ„ λ‚΄μ κ³µκ° ν‚¤λ΅ μ•”νΈν™”
    - κ³µκ° ν‚¤ μ•”νΈ μ‚¬μ©, ν‚¤ κµν™ μ „μ© μ•κ³ λ¦¬μ¦ μ‚¬μ© μ¤‘ μ–΄λ μ½μ„ μ‚¬μ©ν•  μ§€λ” Client/Server Hello ν‘μƒ μ‹ κ²°μ •
- `4λ‹¨κ³„` : μ•”νΈν™”λ ν‚¤μ λ³µνΈν™”
- `5λ‹¨κ³„` : λ³µνΈν™”λ ν‚¤λ΅ ν†µμ‹  β‡’ κ³µν†µ ν‚¤ μ•”νΈ λ°©μ‹ μ•κ³ λ¦¬μ¦ μ‚¬μ©

<aside>
π’΅ ν„μ¬ μ±…μ •μ¤‘μΈ TLS 1.3 λ²„μ „μ—μ„λ” κ³µκ° ν‚¤ μ•”νΈλ¥Ό μ΄μ©ν• ν‚¤ κµν™μ€ νμ§€λ  μμ •

</aside>

## ν†µμ‹ μ κ³ μ†ν™”

- TLS 1.2μ—λ” `μ„Έμ… μ¬κ° κΈ°λ¥`μ΄ μμ–΄ μµμ΄μ ν•Έλ“μ…°μ΄ν¬μ—μ„ μ „μ— μ‚¬μ©ν•λ μ„Έμ… IDλ¥Ό λ³΄λ‚΄λ©΄ μ΄ν›„μ ν‚¤ κµν™ μƒλµ

## μ•”νΈν™” μ¤μ„νΈ

- μ•„λ μ΅°ν•©μ„ λ¦¬μ¤νΈν™”ν•΄ κ΄€λ¦¬ν•κ³  μ„λ²„/ν΄λΌμ΄μ–ΈνΈμ—μ„ κ³µν†µμΌλ΅ μ‚¬μ©ν•  μ μλ” κ²ƒμ„ μ„ νƒν•  μ μλ„λ΅ λ§λ“  μ‹μ¤ν…
    - ν‚¤ κµν™ λ°©λ²•, λ©”μ‹μ§€ μ•”νΈν™”, λ©”μ‹μ§€ μ„λ… λ°©μ‹ λ“±

## ν”„λ΅ν† μ½ μ„ νƒ

- TLSμ—λ” μ• ν”λ¦¬μΌ€μ΄μ… κ³„μΈµ ν”„λ΅ν† μ½μ„ μ„ νƒν•λ” ν™•μ¥ κΈ°λ¥ λ³΄μ 
- TLS μ‚¬μ© μ‹ ν”„λ΅μ‹μ κ°„μ„­μ„ λ°›μ§€ μ•κ³ , ν”„λ΅ν† μ½ λ²„μ „μ„ μ‚¬μ „μ— μ„λ²„μ™€ μ΅°μ •ν•¨μΌλ΅μ¨ νΈν™μ„± μ—†λ” ν”„λ΅ν† μ½λ„ μ΄μ©ν•  μ μμ

# λ©”μ„λ“ λ³€κ²½μ‚¬ν•­

- PUT, DELETE ν•„μ λ©”μ„λ“ μ§€μ • (XMLHttpRequest μ‚¬μ©ν•μ—¬ μ”μ²­ κ°€λ¥)
- OPTION, TRACE, CONNECT λ©”μ„λ“ μ¶”κ°€
    - `OPTION` : μ„λ²„κ°€ λ°›μ•„λ“¤μΌ μ μλ” λ©”μ„λ“ λ©λ΅ λ°ν™
    - `TRACE(TRACK)` : μ”μ²­ ν—¤λ”μ™€ λ°”λ”” λ¦¬ν„΄ (λ³΄μ•μƒμ μ΄μ λ΅ λ―Έμ‚¬μ©)
    - `CONNECT` : HTTP ν”„λ΅ν† μ½μƒμ— λ‹¤λ¥Έ ν”„λ΅ν† μ½μ ν¨ν‚·μ„ νλ¦Ό

# ν”„λ΅ν† μ½ μ—…κ·Έλ μ΄λ“

- HTTP 1.1λ¶€ν„° HTTP μ΄μ™Έμ ν”„λ΅ν† μ½λ΅ μ—…κ·Έλ μ΄λ“ κ°€λ¥
    - HTTP β†’ TLS
    - HTTP β†’ μ›Ήμ†μΌ“μ„ μ‚¬μ©ν• μ–‘λ°©ν–¥ ν†µμ‹ 
    - HTTP β†’ HTTP/2 (h2c)
- HTTP/2μ—μ„ μ‚­μ λ¨

# κ°€μƒ νΈμ¤νΈ μ§€μ›

- ν•λ‚μ μ›Ή μ„λ²„λ΅ μ—¬λ¬ μ›Ή μ„λΉ„μ¤λ¥Ό μ΄μν•λ” λ°©λ²• μ§€μ›
- ν΄λΌμ΄μ–ΈνΈκ°€ `Host` ν—¤λ”μ— μ”μ²­μ„ λ³΄λ‚΄κ³ μ ν•λ” μ„λ²„ μ΄λ¦„μ„ κΈ°μ ν•  μλ¬΄κ°€ μƒκΉ€

# μ²­ν¬

> Transfer-Encoding: chunked
> 
- μ „μ²΄λ¥Ό ν•κΊΌλ²μ— μ „μ†΅ν•μ§€ μ•κ³  μ‘κ² λ‚λ  μ „μ†΅ν•μ—¬ μ‘λ‹µ μ†λ„ κ°μ„ 
- μ²­ν¬ μ„¤μ • μ‹ `Content-Length` ν—¤λ”λ¥Ό ν¬ν•¨ν•΄μ„λ” μ• λ¨
- `0` μ „μ†΅ μ‹ μ²­ν¬ μ „μ†΅μ΄ λ¨λ‘ λλ‚¬λ‹¤λ” λ»
- μ²­ν¬ λ©”μ‹μ§€ λμ— ν—¤λ” μ¶”κ°€ κ°€λ¥
    - Transfer-Encoding
    - Content-Length
    - Trailer

# `curl` μ£Όμ” μµμ…

- `-T` : νμΌ μ „μ†΅
