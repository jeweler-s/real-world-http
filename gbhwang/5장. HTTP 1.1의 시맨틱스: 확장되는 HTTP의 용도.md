# 5장. HTTP/1.1의 시맨틱스: 확장되는 HTTP의 용도

# 파일 다운로드

> Content-Disposition: attachment; filename=filename.xlsx
> 
- 서버 응답에 위 헤더가 포함된 경우 브라우저는 다운로드 대화상자 표시 후 파일 저장
- 브라우저에서 페이지 표시를 리셋하지 않고 다운로드 진행

# 다운로드 중단과 재시작

> Accept-Ranges: bytes          # 바이트 단위 범위 지정 다운로드 수용
> 
- 서버에서 범위 지정 다운로드를 지원하는 경우 위 헤더를 응답에 포함

> Range: bytes=1000-1999    # 원하는 범위 요청
> 
- 요청 시 범위 지정

```java
HTTP/1.1 206 Partial Content
:
Content-Length: 1000                  # 실제로 보낸 바이트 수
Content-Ranges: 1000-1999/5000        # 실제로 반환한 범위 (실제 반환 범위 / 전체 바이트 수)

Content-Type: multipart/byteranges;   # 복수 범위 다운로드 요청 시 포함되는 응답 헤더
```

⇒ 단, `Range` 헤더와 다수 세션을 활용한 병렬 다운로드는 성능상 권장되지 않음

# XMLHttpRequest

- `curl`의 기능을 자바스크립트로 사용 가능하도록 함
- 송수신 시 HTML 화면이 새로고침 되지 않음
- XML, JSON, TEXT 등 다양한 형식 송수신 가능

## 코멧

- `XMLHttpRequest`를 사용한 거의 실시간 양방향 통신에 가까운 기술
- 롱 폴링을 사용한 구현 방법
    - `폴링` : 클라이언트에서 이벤트 발생 여부 주기적으로 체크 ⇒ 불필요 네트워크, CPU 낭비
    - `롱 폴링` : 요청 후 서버 내 이벤트 발생 시 클라이언트에 응답

## 보안 제약사항

### 액세스 가능 정보 제한

- 보안상의 이유로 쿠키 액세스 제한

### 전송 제한

- `도메인` : CORS를 이용한 동일 출처 리소스만 허용하는 정책 사용
- `메서드` : `CONNECT`, `TRACE`, `TRACK` 메서드 사용하여 전송 시 예외 발생
- `헤더` : 현재의 프로토콜 규약이나 환경에 영향을 미치거나, 보안에 영향을 주거나, 브라우저의 능력을 넘을 수 없는 것은 전송 금지

# GeoLocation

## 클라이언트 자신의 위치 확인

- 모던 브라우저에서 제공하는 지오로케이션 API 사용

## 서버가 클라이언트의 위치 확인

- IP 주소는 지역마다 등록 관리 기관이 있어, 기업이나 프로바이더 등에 IP 주소 할당
- 이러한 정보를 모아 제공하는 서비스를 사용하여 확인 (ex. 맥스마인드 등)

# 원격 프로시저 호출

- 다른 컴퓨터에 있는 기능을 마치 자신의 컴퓨터 안에 있는 것처럼 호출하는 기능
    - `XML-RPC` , `JSON-RPC`
    - `SOAP` : `XML-RPC`를 확장하여 만들어진 규격

# 웹사이트 간 인증 및 허가 플랫폼

## 용어

- `인증` : 사용자가 누구인지 확인
- `인가` : 인증된 사용자가 누구인지 파악 후, 사용자에게 어디까지 권한을 부여할지 확인

## 종류

- `SSO` : 시스템 간 계정 관리를 따로 하지 않고 한 번의 로그인을 통해 전 시스템에 유효하게 함
- `커베로스 인증` : 사용자 관리 구조를 하나로 정리해 모든 시스템에서 이용 (ex. `LDAP`, `AD`)
- `SAML` : 웹 계통의 기술(HTTP/SOAP)을 전제로 한 SSO 구조
- `OpenID` : 이미 등록된 웹 서비스의 사용자 정보로 다른 서비스에 로그인
- `OpenSocial` : 소셜 네트워크 공통 API, 현재는 W3C로 이관되어 소셜 웹 프로토콜로 사양 책정
- `OAuth` : 인증보다 인가에 특화된 시스템
- `OpenID Connect` : OAuth 2.0을 기반으로 인증 및 인가 모두 사용 가능하도록 확장한 규격
    - OAuth 2.0에 비해 사용자 프로필에 액세스하는 방법을 규격화함
